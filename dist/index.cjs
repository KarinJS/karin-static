"use strict";var w=Object.create;var l=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var T=(t,s,n,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let e of b(s))!j.call(t,e)&&e!==n&&l(t,e,{get:()=>s[e],enumerable:!(r=x(s,e))||r.enumerable});return t};var a=(t,s,n)=>(n=t!=null?w(S(t)):{},T(s||!t||!t.__esModule?l(n,"default",{value:t,enumerable:!0}):n,t));var c=a(require("fs"),1),f=a(require("crypto"),1);var y=a(require("fs"),1),g=a(require("axios"),1),L=async t=>{let s={object_key:t,file_type:"jpg",is_avatar:!0,content_type:"image/png"};return(await g.default.post(process.env.API,s)).data},d=async(t,s)=>{let n=await L(t),r=Object.keys(n)[0],e=n[r],o=y.default.createReadStream(s);return await g.default.put(r,o,{headers:{"Content-Type":e["Content-Type"],"x-obs-acl":e["x-obs-acl"],Host:e.Host},maxBodyLength:1/0,maxContentLength:1/0}),e["cdn-img-addr"]};var m=a(require("axios"),1),u=t=>{let s=f.default.createHash("md5"),n=c.default.readFileSync(t,"utf-8");return s.update(n),s.digest("hex")},H=()=>JSON.parse(c.default.readFileSync("./list.json","utf-8")),k=async()=>{let t={},{data:s}=await m.default.get("https://raw.githubusercontent.com/KarinJS/files/refs/heads/main/result.json"),n=H(),r=u(n[0].path),e=await d(r,n[0].path);t[r]={...n[0],url:e,time:Date.now()},n.shift(),await Promise.all(n.map(async o=>{let i=u(o.path),p=s[i];if(p&&(await m.default.head(p.url)).status===200){t[i]=p;return}let h=await d(i,o.path);t[i]={...o,url:h,time:Date.now()}})),c.default.writeFileSync("./result.json",JSON.stringify(t,null,2)),console.log(`\u{1F389} \u4E0A\u4F20\u6210\u529F \u5171 ${Object.keys(t).length} \u4E2A\u6587\u4EF6`)};k();
