"use strict";var u=Object.create;var p=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var b=(t,s,r,e)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of h(s))!x.call(t,n)&&n!==r&&p(t,n,{get:()=>s[n],enumerable:!(e=f(s,n))||e.enumerable});return t};var a=(t,s,r)=>(r=t!=null?u(w(t)):{},b(s||!t||!t.__esModule?p(r,"default",{value:t,enumerable:!0}):r,t));var i=a(require("fs"),1),l=a(require("crypto"),1);var d=a(require("fs"),1),c=a(require("axios"),1),j=async t=>{let s={object_key:t,file_type:"jpg",is_avatar:!0,content_type:"image/png"};try{return(await c.default.post(process.env.API,s)).data}catch{throw new Error("\u83B7\u53D6CDN\u63A5\u53E3\u4FE1\u606F\u5931\u8D25")}},m=async(t,s)=>{let r=await j(t),e=Object.keys(r)[0],n=r[e],o=d.default.createReadStream(s);return await c.default.put(e,o,{headers:{"Content-Type":n["Content-Type"],"x-obs-acl":n["x-obs-acl"],Host:n.Host},maxBodyLength:1/0,maxContentLength:1/0}),n["cdn-img-addr"]};var g=a(require("axios"),1),C=t=>{let s=l.default.createHash("md5"),r=i.default.readFileSync(t,"utf-8");return s.update(r),s.digest("hex")},T=()=>JSON.parse(i.default.readFileSync("./list.json","utf-8")),L=async()=>{let t={},{data:s}=await g.default.get("https://raw.githubusercontent.com/KarinJS/files/refs/heads/main/result.json"),r=T();await Promise.all(r.map(async e=>{let n=C(e.path),o=s[n];if(o&&(await g.default.head(o.url)).status===200){t[n]=o;return}let y=await m(n,e.path);t[n]={...e,url:y,time:Date.now()}})),i.default.writeFileSync("./result.json",JSON.stringify(t,null,2)),console.log(`\u{1F389} \u4E0A\u4F20\u6210\u529F \u5171 ${Object.keys(t).length} \u4E2A\u6587\u4EF6`)};L();
